!function(){"use strict";const e=e=>window.btoa(unescape(encodeURIComponent(e))),t=`o-countdown-last-visit-${e(window.location.pathname)}-`,i=`o-countdown-last-visit-time-${e(window.location.pathname)}-`,n=`o-countdown-last-visit-timezone-${e(window.location.pathname)}-`;let o=0;class s{constructor(e){var s,a,d,r,l,h;this.id=o++,this.elem=e,this.elem.classList.add("ready");const{date:c,bhv:u,mode:m,timer:w,redirectLink:v,intvEnd:g,intvStart:p,onEndAction:b}=e.dataset;switch(this.rawData=null!=c?c:"",this.behavior=null!==(s=u)&&void 0!==s?s:"default",this.mode=m,this.timer=null!=w?w:"0",this.redirectLink=v,this.startInterval=p,this.endInterval=g,this.hideTime=0,this.onEndAction=b,this.checks={show:!1},this.currentTime=Date.now(),this.components={},["second","minute","hour","day"].forEach((t=>{const i=e.querySelector(`div[name=${t}]`);if(i){const e=i.querySelector(".otter-countdown__label"),n=i.querySelector(".otter-countdown__value");this.components[t]={label:null!=e?e:void 0,value:null!=n?n:void 0}}})),this.onEndEvents=[()=>this.activateBehavior(),()=>this.activateActions()],this.mode){case"timer":const e=null!==(a=localStorage.getItem(`${t}-${this.elem.id}`))&&void 0!==a?a:"0",o=localStorage.getItem(`${i}-${this.elem.id}`),s=null!==(d=localStorage.getItem(`${n}-${this.elem.id}`))&&void 0!==d?d:"0";this.deadline=parseInt(e)+parseInt(this.timer),(!e||0>parseInt(e)+parseInt(this.timer)-Date.now()||o!==this.timer||s!=(new Date).getTimezoneOffset().toString())&&(localStorage.setItem(`${t}-${this.elem.id}`,Date.now().toString()),localStorage.setItem(`${i}-${this.elem.id}`,this.timer),localStorage.setItem(`${n}-${this.elem.id}`,(new Date).getTimezoneOffset().toString()),this.deadline=Date.now()+parseInt(this.timer));break;case"interval":this.deadline=this.endInterval?new Date(this.endInterval+(null!==(r=window?.themeisleGutenbergCountdown?.timezone)&&void 0!==r?r:"")).getTime():0,this.hideTime=this.startInterval?new Date(this.startInterval+(null!==(l=window?.themeisleGutenbergCountdown?.timezone)&&void 0!==l?l:"")).getTime():0;break;default:this.deadline=this.rawData?new Date(this.rawData+(null!==(h=window?.themeisleGutenbergCountdown?.timezone)&&void 0!==h?h:"")).getTime():Date.now()}this.hideOrShow(this.isStopped&&"hide"===this.behavior||this.mustBeHidden)}update(e){"interval"!==this.mode||this.checks.show||this.hideOrShow(this.mustBeHidden),e.forEach((e=>{var t;this.components?.[e.tag]?.label&&this.components[e.tag]?.label?.innerHTML!==e.label&&(this.components[e.tag].label.innerHTML=null!==(t=e.label)&&void 0!==t?t:""),this.components?.[e.tag]?.value&&(this.components[e.tag].value.innerHTML=e.value)}))}onEnd(e){this.onEndEvents.push(e)}end(){const e=new CustomEvent("o-countdown-stop",{bubbles:!0,detail:{countdown:this}});this.elem.dispatchEvent(e),this.onEndEvents.forEach((e=>e()))}activateBehavior(){switch(this.behavior){case"default":break;case"hide":this.hide();break;case"redirectLink":this.redirectLink&&window.location.replace(this.redirectLink)}}activateActions(){const e=this.connectedBlocksSelector;e&&"all"===this.onEndAction&&(document.querySelectorAll(`${e}.o-cntdn-bhv-hide`).forEach((e=>e.classList.add("o-cntdn-hide"))),document.querySelectorAll(`${e}.o-cntdn-bhv-show`).forEach((e=>e.classList.remove("o-cntdn-bhv-show"))))}hideOrShow(e){e?this.hide():(this.checks.show=!0,this.show(),document.querySelectorAll(`${this.connectedBlocksSelector}.o-cntdn-bhv-hide`).forEach((e=>{e.classList.add("o-cntdn-ready")})))}hide(){this.elem.classList.add("o-hide")}show(){this.elem.classList.add("o-cntdn-ready"),this.elem.classList.remove("o-hide")}get connectedBlocksSelector(){return void 0===this.elem.id?null:`.o-countdown-trigger-on-end-${this.elem.id.split("-").pop()}`}get remainingTime(){return this.deadline-this.currentTime}get isStopped(){return 0>=this.remainingTime}get mustBeHidden(){return void 0!==this.startInterval&&0<=this.hideTime-this.currentTime}set time(e){this.currentTime=e}}class a{constructor(){this.countdowns={},this.running=new Set,this.stopped=new Set}register(e){e&&(e.onEnd((()=>{this.running.delete(e.id),this.stopped.add(e.id)})),this.countdowns[e.id]=e,this.running.add(e.id))}startTimer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;this.timer=setInterval((()=>{this.update()}),e)}update(){const e=Date.now();this.running.forEach((t=>{this.updateCountdown(this.countdowns[t],e)})),0===this.running.size&&this.stopTimer()}stopTimer(){clearInterval(this.timer)}updateCountdown(e,t){const{id:i}=e;e.time=t;try{const{remainingTime:t}=e,i=Math.floor(t/864e5),n=Math.floor(t/36e5%24),o=Math.floor(t/6e4%60),s=Math.floor(t/1e3%60),{i18n:a}=window.themeisleGutenbergCountdown,d=[{tag:"day",label:1<i?a.days:a.day,value:i},{tag:"hour",label:1<n?a.hours:a.hour,value:n},{tag:"minute",label:1<o?a.minutes:a.minute,value:o},{tag:"second",label:1<s?a.seconds:a.second,value:s}].filter((t=>{let{tag:i}=t;return!e.settings?.exclude?.includes(i)})).map((t=>({...t,value:e.settings?.keepNeg?t.value.toString():Math.max(0,t.value).toString()})));e.update(d),e.isStopped&&e.end()}catch(e){console.error(e),this.running.delete(i)}}}var d;d=()=>{const e=document.querySelectorAll(".wp-block-themeisle-blocks-countdown"),t=new a;e.forEach((e=>{const i=new s(e);t.register(i)})),t.update(),t.startTimer()},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",d):d())}();