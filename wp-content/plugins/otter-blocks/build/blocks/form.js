!function(){"use strict";let e=null;const t=(t,s,r)=>{const n=t?.id,i={},{formFieldsData:l,elemsWithError:a}=(e=>{const t=[],o=[{label:window?.themeisleGutenbergForm?.messages["form-submission"]||"Form submission from",value:window.location.href}],s=e?.querySelectorAll(".otter-form__container .wp-block-themeisle-blocks-form-input"),r=e?.querySelectorAll(".otter-form__container .wp-block-themeisle-blocks-form-textarea");return[...s,...r]?.forEach((e=>{const s=e.querySelector(".otter-form-input-label__label, .otter-form-textarea-label__label")?.innerHTML,r=e.querySelector(".otter-form-input, .otter-form-textarea-input"),{id:n}=e,i=e.querySelector('.otter-form-input[type="checkbox"]')?.checked;r?.hasAttribute("required")&&!r?.checkValidity()&&t.push(r),s&&r?.value&&o.push({value:r?.value,type:r?.type,label:s,checked:i,id:n})})),{formFieldsData:o,elemsWithError:t}})(t),c=2>l?.length,d=function(e){const t=`.protection #${e.id||""}_nonce_field`;return e.querySelector(t)?.value}(t),m=t?.classList?.contains("has-captcha"),h=n&&window.themeisleGutenberg?.tokens?.[n]?.token,u=document.createElement("span");if(u.classList.add("spinner"),s.appendChild(u),c)return s.disabled=!1,void s.removeChild(u);if(a.forEach((e=>{e?.reportValidity()})),m&&!h){const e=window.hasOwnProperty("grecaptcha")?"check-captcha":"captcha-not-loaded";r.pullMsg(e,"error").show()}if(0<a.length||m&&!h)s.disabled=!1,s.removeChild(u);else{var b,w;i.formInputsData=l,h&&(i.token=window.themeisleGutenberg?.tokens?.[n].token),""!==t?.dataset?.emailSubject&&(i.emailSubject=t?.dataset?.emailSubject),t?.dataset?.optionName&&(i.formOption=t?.dataset?.optionName),t?.id&&(i.formId=t?.id),d&&(i.nonceValue=d),i.antiSpamTime=Date.now()-(null!==(b=e)&&void 0!==b?b:Date.now()),i.antiSpamHoneyPot=Boolean(null!==(w=t.querySelector(":scope > .otter-form__container > .protection .o-anti-bot")?.checked)&&void 0!==w&&w),i.postUrl=window.location.href,t.classList.contains("can-submit-and-subscribe")&&(i.action="submit-subscribe",i.consent=t.querySelector(".otter-form-consent input")?.checked||!1);const a=(window?.themeisleGutenbergForm?.root||window.location.origin+"/wp-json/")+"otter/v1/form/frontend";fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, */*;q=0.1","X-WP-Nonce":window?.themeisleGutenbergForm?.nonce},credentials:"include",body:JSON.stringify({handler:"submit",payload:i})}).then((e=>e.json())).then((e=>{const i=e;if("0"===i?.code||"1"===i?.code||i?.success){const e=i?.submitMessage?i.submitMessage:"Success";r.setMsg(e).show(),o(t),setTimeout((()=>{if(0<i?.redirectLink?.length){let e=document.createElement("a");e.target="_blank",e.href=i.redirectLink,e.click()}}),1e3)}else{let e="";"110"===i.code?r.setMsg(i?.reasons?.join(""),"error").show():0<i?.displayError?.length?(e=i?.displayError,r.setMsg(e,"error").show()):r.setMsg(i?.reasons?.join(""),"error").show(),console.error(`(${i?.code}) ${i?.reasons?.join("")}`)}window.themeisleGutenberg?.tokens?.[n].reset&&window.themeisleGutenberg?.tokens?.[n].reset(),s.disabled=!1,s.removeChild(u)}))?.catch((e=>{console.error(e),r.pullMsg("try-again","error").show(),window.themeisleGutenberg?.tokens?.[n].reset&&window.themeisleGutenberg?.tokens?.[n].reset(),s.disabled=!1,s.removeChild(u)}))}},o=e=>{const t=e?.querySelectorAll(":scope > .otter-form__container > .wp-block-themeisle-blocks-form-input"),o=e?.querySelectorAll(":scope > .otter-form__container > .wp-block-themeisle-blocks-form-textarea");[...t,...o]?.forEach((e=>{const t=e.querySelector(".otter-form-input, .otter-form-textarea-input");t?.value&&(t.value=null)}))};var s;s=()=>{const o=document.querySelectorAll(".wp-block-themeisle-blocks-form");(e=>{if(!window.hasOwnProperty("grecaptcha")&&window?.themeisleGutenbergForm?.reRecaptchaSitekey){const t=document.createElement("script");t.id="recaptcha",document.body.appendChild(t),t.addEventListener("load",(()=>{const t=setInterval((()=>{window.hasOwnProperty("grecaptcha")&&window.grecaptcha.hasOwnProperty("render")&&(e.forEach((e=>{e?.classList?.contains("has-captcha")&&(e=>{if(!window.hasOwnProperty("grecaptcha"))return;const{id:t}=e,o=document.createElement("div"),s=e.querySelector(".otter-form__container");s?.insertBefore(o,s.lastChild);const r=window.grecaptcha?.render(o,{sitekey:window?.themeisleGutenbergForm?.reRecaptchaSitekey,callback:e=>{window.themeisleGutenberg||(window.themeisleGutenberg={}),window.themeisleGutenberg?.tokens||(window.themeisleGutenberg.tokens={}),window.themeisleGutenberg.tokens[t]={token:e,reset:()=>window.grecaptcha?.reset(r)}},"expired-callback":()=>{window.themeisleGutenberg?.tokens||(window.themeisleGutenberg={},window.themeisleGutenberg.tokens={}),window.themeisleGutenberg.tokens[t]={token:null,reset:()=>null}}})})(e)})),clearInterval(t))}),200)})),t.src=window?.themeisleGutenbergForm?.reRecaptchaAPIURL}})(o),e=Date.now(),o.forEach((e=>{e.classList.contains("can-submit-and-subscribe")&&(e=>{const t=e.querySelector(".otter-form__container"),o=e.querySelector(".wp-block-button"),s=document.createElement("div");s.classList.add("otter-form-consent"),t.insertBefore(s,o);const r=document.createElement("input");r.type="checkbox",r.name="o-consent",r.id="o-consent";const n=document.createElement("label");n.innerHTML=window?.themeisleGutenbergForm?.messages?.privacy||"I have read and agreed the privacy statement.",n.htmlFor="o-consent",s.appendChild(r),s.appendChild(n)})(e);const o=e.querySelector("button"),s=new class{constructor(e){this.form=e,this.anchor=e.querySelector(".wp-block-button"),this.anchor?.classList.add("has-submit-msg"),this.msgElem=document.createElement("div"),this.msgElem.classList.add("o-form-server-response"),this.anchor.appendChild(this.msgElem),this.isVisible=!1,this.visibilityTimeout=void 0,this.visibilityDuration=12e3}toggle(e){this.isVisible=void 0!==e?e:!this.isVisible,this.msgElem.style.display=this.isVisible?"block":"none"}pullMsg(e,t){return this.setMsg(window?.themeisleGutenbergForm?.messages[e]||"Messages are missing!",t)}setMsg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";switch(this.msgElem.innerHTML=e,this.clean(),t){case"error":this.msgElem.classList.toggle("o-error",!0);break;case"warning":this.msgElem.classList.toggle("o-warning",!0);break;default:this.msgElem.classList.toggle("o-success",!0)}return this}show(e){clearTimeout(this.visibilityTimeout),this.toggle(!0),this.visibilityTimeout=setTimeout((()=>{this.toggle(!1)}),e||this.visibilityDuration)}clean(){this.msgElem.classList.toggle("o-error",!1),this.msgElem.classList.toggle("o-warning",!1),this.msgElem.classList.toggle("o-success",!1)}}(e);e.querySelector('button[type="submit"]')?e?.addEventListener("submit",(r=>{r.preventDefault(),o.disabled||(o.disabled=!0,t(e,o,s))}),!1):o?.addEventListener("click",(r=>{r.preventDefault(),o.disabled||(o.disabled=!0,t(e,o,s))}),!1)}))},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",s):s())}();